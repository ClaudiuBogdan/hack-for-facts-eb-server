{
  "$schema": "https://opencode.ai/config.json",
  // ============================================================================
  // OPENCODE CONFIGURATION - Transparenta.eu Server
  // Optimized for Claude Opus 4.5 with Deep/Fast Mode Switching
  // ============================================================================
  // Primary model - Use deep reasoning alias by default
  "model": "anthropic/opus-deep",
  // Lightweight model for title generation and simple tasks
  "small_model": "anthropic/claude-haiku-4-5-20251001",
  // Theme
  "theme": "opencode",
  // Auto-update OpenCode
  "autoupdate": true,
  // ============================================================================
  // INSTRUCTIONS - Project documentation loaded into context
  // ============================================================================
  "instructions": [
    "AGENTS.md",
    "prompts/ask-user.md",
    "docs/ARCHITECTURE.md",
    "docs/CORE-SHELL-ARCHITECTURE.md",
    "docs/MODULE-DEPENDENCIES.md",
  ],
  // ============================================================================
  // TUI CONFIGURATION
  // ============================================================================
  "tui": {
    "scroll_speed": 1,
    "scroll_acceleration": {
      "enabled": false
    },
  },
  // ============================================================================
  // FORMATTER CONFIGURATION - Use Prettier for code formatting
  // ============================================================================
  "formatter": {
    "prettier": {
      "command": [
        "pnpm",
        "exec",
        "prettier",
        "--write",
        "$FILE"
      ],
      "extensions": [
        ".ts",
        ".tsx",
        ".js",
        ".jsx",
        ".json",
        ".md",
        ".yaml",
        ".yml"
      ],
    },
  },
  // ============================================================================
  // GLOBAL TOOL CONFIGURATION
  // ============================================================================
  "tools": {
    "read": true,
    "write": true,
    "edit": true,
    "bash": true,
    "grep": true,
    "glob": true,
    "list": true,
    "webfetch": true,
    "todowrite": true,
    "todoread": true
  },
  // ============================================================================
  // GLOBAL PERMISSIONS
  // ============================================================================
  "permission": {
    "edit": "allow",
    "webfetch": "allow",
    "external_directory": "ask",
    "doom_loop": "ask",
    "bash": {
      // ─────────────────────────────────────────────────────────────────────
      // Security - Block access to .env files (contains secrets)
      // ─────────────────────────────────────────────────────────────────────
      "cat *.env*": "deny",
      "cat .env*": "deny",
      "cat */.env*": "deny",
      "head *.env*": "deny",
      "head .env*": "deny",
      "head */.env*": "deny",
      "tail *.env*": "deny",
      "tail .env*": "deny",
      "tail */.env*": "deny",
      "less *.env*": "deny",
      "less .env*": "deny",
      "more *.env*": "deny",
      "more .env*": "deny",
      // ─────────────────────────────────────────────────────────────────────
      // Git - Read operations (always allow)
      // ─────────────────────────────────────────────────────────────────────
      "git status": "allow",
      "git diff*": "allow",
      "git log*": "allow",
      "git branch*": "allow",
      "git show*": "allow",
      "git blame*": "allow",
      // ─────────────────────────────────────────────────────────────────────
      // File inspection (always allow)
      // ─────────────────────────────────────────────────────────────────────
      "ls *": "allow",
      "cat *": "allow",
      "head *": "allow",
      "tail *": "allow",
      "grep *": "allow",
      "rg *": "allow",
      "find *": "allow",
      "pwd": "allow",
      "echo *": "allow",
      "which *": "allow",
      "wc *": "allow",
      // ─────────────────────────────────────────────────────────────────────
      // pnpm - Project package manager (primary)
      // ─────────────────────────────────────────────────────────────────────
      "pnpm run *": "allow",
      "pnpm test*": "allow",
      "pnpm vitest*": "allow",
      "pnpm install*": "allow",
      "pnpm exec *": "allow",
      "pnpm typecheck": "allow",
      "pnpm lint": "allow",
      "pnpm format": "allow",
      "pnpm build": "allow",
      "pnpm ci": "allow",
      "pnpm deps:*": "allow",
      // ─────────────────────────────────────────────────────────────────────
      // npm/bun/yarn - Fallback package managers
      // ─────────────────────────────────────────────────────────────────────
      "npm run *": "allow",
      "npm test*": "allow",
      "npm install*": "allow",
      "bun run *": "allow",
      "bun test*": "allow",
      "bun install*": "allow",
      "yarn *": "allow",
      // ─────────────────────────────────────────────────────────────────────
      // Docker - Container operations
      // ─────────────────────────────────────────────────────────────────────
      "docker build*": "allow",
      "docker run*": "allow",
      "docker compose*": "allow",
      "docker logs*": "allow",
      "docker ps*": "allow",
      // ─────────────────────────────────────────────────────────────────────
      // Database - PostgreSQL operations
      // ─────────────────────────────────────────────────────────────────────
      "psql *": "allow",
      "pg_dump *": "allow",
      // ─────────────────────────────────────────────────────────────────────
      // Potentially destructive - ask first
      // ─────────────────────────────────────────────────────────────────────
      "git push*": "ask",
      "git commit*": "ask",
      "git merge*": "ask",
      "git rebase*": "ask",
      "git reset*": "ask",
      "git checkout*": "ask",
      "git stash*": "ask",
      "rm *": "ask",
      "mv *": "ask",
      "cp *": "ask",
      "chmod *": "ask",
      "chown *": "ask",
      "sudo *": "ask",
      "npm publish*": "ask",
      "docker push*": "ask",
      // Default for everything else
      "*": "ask",
    },
  },
  // ============================================================================
  // CUSTOM COMMANDS - Quick access to common workflows
  // ============================================================================
  "command": {
    "test": {
      "template": "Run the test suite with `pnpm test`. If there are failures, analyze them and suggest fixes. Focus on the failing tests first.",
      "description": "Run all tests and analyze failures",
      "agent": "build"
    },
    "test-unit": {
      "template": "Run unit tests with `pnpm test:unit`. Analyze any failures and suggest fixes based on the test patterns in tests/unit/.",
      "description": "Run unit tests only",
      "agent": "build"
    },
    "lint": {
      "template": "Run `pnpm lint` to check for linting errors. Fix any issues found, following the ESLint configuration in eslint.config.mjs.",
      "description": "Run linter and fix issues",
      "agent": "build"
    },
    "typecheck": {
      "template": "Run `pnpm typecheck` to check for TypeScript errors. Analyze and fix any type errors found.",
      "description": "Run TypeScript type checking",
      "agent": "build"
    },
    "ci": {
      "template": "Run the full CI pipeline with `pnpm ci` (typecheck + lint + test + build). Report any failures and help fix them.",
      "description": "Run full CI pipeline",
      "agent": "build"
    },
    "review": {
      "template": "Review the recent changes using `git diff`. Focus on:\n1. Code quality and best practices\n2. Security vulnerabilities\n3. Performance implications\n4. Test coverage\n5. Adherence to project architecture (Functional Core / Imperative Shell)",
      "description": "Review recent code changes",
      "agent": "review-max"
    },
    "deps": {
      "template": "Run `pnpm deps:check` to check for circular dependencies. If found, analyze the import graph and suggest how to break the cycles following the module dependency rules in docs/MODULE-DEPENDENCIES.md.",
      "description": "Check for circular dependencies",
      "agent": "plan-max"
    }
  },
  // ============================================================================
  // AGENT CONFIGURATION
  // Tab cycle: build-max → build → build-fast → plan-max → architect-max → review-max → implement-max
  // ============================================================================
  "agent": {
    // ─────────────────────────────────────────────────────────────────────────
    // PRIMARY AGENTS (Tab to switch)
    // ─────────────────────────────────────────────────────────────────────────`
    // BUILD - Standard development with deep reasoning
    "build": {
      "description": "Standard development - balanced speed and reasoning",
      "mode": "primary",
      "temperature": 0.1,
      "maxSteps": 100,
      "prompt": "{file:prompts/build.md}",
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "bash": true,
        "grep": true,
        "glob": true,
        "list": true,
        "webfetch": true,
        "todowrite": true,
        "todoread": true,
        "ask_user": true
      },
      "permission": {
        "edit": "allow",
        "bash": {
          "pnpm *": "allow",
          "git status": "allow",
          "git diff*": "allow",
          "git log*": "allow",
          "*": "ask"
        }
      }
    },
    "architect": {
      "description": "System architecture - design decisions and documentation",
      "mode": "primary",
      "temperature": 0.3,
      "maxSteps": 100,
      "prompt": "{file:prompts/architect.md}",
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "bash": true,
        "grep": true,
        "glob": true,
        "list": true,
        "webfetch": true,
        "todowrite": true,
        "todoread": true,
        "ask_user": true
      },
      "permission": {
        "edit": "ask",
        "bash": "ask"
      }
    },
    "review-max": {
      "description": "Code review - security, performance, architecture compliance",
      "mode": "primary",
      "temperature": 0.3,
      "maxSteps": 100,
      "prompt": "{file:prompts/reviewer.md}",
      "tools": {
        "read": true,
        "write": false,
        "edit": false,
        "bash": true,
        "grep": true,
        "glob": true,
        "list": true,
        "webfetch": true,
        "todowrite": true,
        "todoread": true,
        "ask_user": true
      },
      "permission": {
        "edit": "deny",
        "bash": {
          "git diff*": "allow",
          "git log*": "allow",
          "git show*": "allow",
          "pnpm run lint*": "allow",
          "pnpm test*": "allow",
          "pnpm vitest*": "allow",
          "*": "deny"
        }
      }
    },
    "explore": {
      "description": "Fast codebase exploration and file search",
      "mode": "subagent",
      "model": "anthropic/sonnet",
      "temperature": 0.1,
      "maxSteps": 20,
      "tools": {
        "read": true,
        "write": false,
        "edit": false,
        "bash": false,
        "grep": true,
        "glob": true,
        "list": true
      }
    }
  },
  // ============================================================================
  // MCP SERVERS (Model Context Protocol)
  // ============================================================================
  "mcp": {
    // Context7 - Documentation search for libraries and frameworks
    "context7": {
      "type": "remote",
      "url": "https://mcp.context7.com/mcp",
      "enabled": true,
      // Add API key for higher rate limits:
      // "headers": {
      //   "CONTEXT7_API_KEY": "{env:CONTEXT7_API_KEY}"
      // }
    },
    // PostgreSQL MCP - Database introspection (uncomment to enable)
    // "postgres": {
    //   "type": "local",
    //   "command": ["npx", "-y", "@modelcontextprotocol/server-postgres"],
    //   "environment": {
    //     "DATABASE_URL": "{env:DATABASE_URL}"
    //   },
    //   "enabled": false
    // }
  },
  // ============================================================================
  // DISABLED PROVIDERS
  // ============================================================================
  "disabled_providers": [],
}
